CREATE OR REPLACE TABLE SALES_DATA

  ( ORDER_ID VARCHAR(50),
    ORDER_DATE STRING , 
    SHIP_DATE STRING ,
    SHIP_MODE VARCHAR (50),
    CUSTOMER_NAME VARCHAR (50),
    SEGMENT VARCHAR (50) ,
    STATE VARCHAR (50) ,
    COUNTRY VARCHAR (50),
    MARKET VARCHAR (50) ,
    REGION VARCHAR (50), 
    PRODUCT_ID VARCHAR (200),
    CATEGORY VARCHAR (50),
    SUB_CATEGORY VARCHAR (50),
    PRODUCT_NAME VARCHAR (200),
    SALES INT ,
    QUANTITY VARCHAR (50) ,
    DISCOUNT VARCHAR (50) ,
    PROFIT INT ,
    SHIPPING_COST VARCHAR (50),
    ORDER_PRIORITY VARCHAR (50),
    YEAR INT 
    ) ;
    DESCRIBE TABLE SALES_DATA ;

    select * from SALES_DATA ;


----2 QUESTION ---
/*  A primary key I ALREADY INSERTED IN THE TABLE WHILE CREATING */


---3 QUESTION ----

CREATE OR REPLACE TABLE  SALES_DATA AS
SELECT*,
CHAR (DATE(ORDER_DATE,'MM-DD-YYYY'),'YYYY-MM-DD') AS ORDER_DATE_REPLACED 
     FROM  SALES_DATA;

CREATE OR REPLACE TABLE  SALES_DATA AS
SELECT*,
CHAR (DATE(SHIP_DATE,'MM-DD-YYYY'),'YYYY-MM-DD') AS SHIP_DATE_REPLACED 
     FROM  SALES_DATA;


----4 QUESTION----Create a new column called order_extract and extract the number after the last '–‘from Order ID column.

CREATE OR REPLACE TABLE SALES_DATA AS 
SELECT  ORDER_ID, SUBSTRING(ORDER_ID, 9,10)
FROM SALES_DATA;

ALTER TABLE SALES_DATA 
ADD COLUMN SALES_DATA_NEW VARCHAR(20) ;

UPDATE ORDER_ID_NEW 
SET ORDER_ID_NEW = SUBSTRING (ORDER_ID,9,10);

-----5 QUESTION ---

CREATE OR REPLACE TABLE SALES_DATA AS
 SELECT*,
         CASE 
         WHEN DISCOUNT>0 THEN 'YES'
         ELSE 'FALSE'
         END AS AFTER_DISCOUNT 
       FROM SALES_DATA;

---- 6 QUESTION ----

DATEDIFF('DAYS',ORDER_ID),ORDER_DATE_REPLACED,SHIP_DATE_REPLACED,) AS DAYS_TAKEN_TO_PROCESS_ORDER
FROM SALES_DATA;

----7 QUESTION ---

CREATE OR REPLACE TABLE SALES_DATA; AS 

SELECT*,

         CASE 
             WHEN DAYS_TAKEN_TO_PROCESS_ORDER < 3 THEN 5
             WHEN DAYS_TAKEN_TO_PROCESS_ORDER BETWEEN 4 AND 6 THEN 4
             WHEN DAYS_TAKEN_TO_PROCESS_ORDER 7 AND 10 THEN 3 
             ELSE 2 
             END AS RATING
             FROM SALES_DATA;
